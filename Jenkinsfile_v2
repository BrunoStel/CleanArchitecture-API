def verifyPathBFF(){
  dir ('pathsModified') {
    if (fileExists('app-backend.txt')){
        return true
    }else {
      echo "Mandandno mensagem sobre sonar BFF"
    }
  }
}

def verifyPathMobile(){
  dir ('pathsModified') {
    if (fileExists('app-mobile.txt')){
      return true
    }else {
      echo "Mandandno mensagem sobre sonar mobile"
    }
      
  }
}
def verifyFilesModified(){
  sh """chmod a+x filesModified.sh && ./filesModified.sh"""
}
pipeline {
    agent any
    stages{
          stage('Verificando Arquivos modificados'){
          steps{
              script{
                verifyFilesModified()
              }
          }
        }

        stage('Sonar - BFF') {
          when {
              expression { verifyPathBFF() } 
          }
          steps {
              echo "RODANDO SONAR BFF"
          }
        }
        stage('Sonar - Mobile') {
          when {
              expression { verifyPathMobile() } 
          }
          steps {
              echo "RODANDO SONAR MOBILE"
          }
        }
        stage('Delete dir'){
          steps{
            script{
              deleteDir()
            }
          }
        }
    }
}
